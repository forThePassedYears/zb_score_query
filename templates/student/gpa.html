{% extends 'student/tables.html' %}

{% block title %}
    <title>绩点查询</title>
    <style>
        div.card-body ul li {
            line-height: 50px;
        }
    </style>
{% endblock %}

{% block content %}
    <div class="row">
        {% if error_message %}
            <div class="col-lg-12 mb-5">
                <h1 align="center" style="margin-top: 150px">{{ error_message }}</h1>
            </div>
        {% else %}
            <div class="col-lg-6 mb-5">
                <div class="card">
                    <div class="card-header">
                        <h6 class="text-uppercase mb-0">平均绩点 计算结果</h6>
                        <span class="text-uppercase" style="font-size: 11px">成绩集合为当前可获取到的 全部及格成绩 + 尚不及格成绩</span>
                    </div>
                    <div class="card-body">
                        <table class="table card-text">
                            <thead>
                            <tr>
                                <th>算法标准</th>
                                <th>算法结果</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>
                                    <label for="mode"></label>
                                    <select name="algorithm_mode" id="mode">
                                        <option value="zb">中北</option>
                                        <option value="bz">标准4.0</option>
                                        <option value="gj">改进4.0</option>
                                        <option value="gj2">改进(2)4.0</option>
                                        <option value="bd">北大4.0</option>
                                        <option value="jnd">加拿大4.3</option>
                                        <option value="zkd">中科大4.3</option>
                                        <option value="shjd">上海交大4.3</option>
                                    </select>
                                </td>
                                <td id="point">{{ current_point }}</td>
                            </tr>
                            <tr>
                                <td colspan="2" align="center">
                                    <button id="export" class="btn btn-lg btn-primary">导出成绩单</button>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="card" style="margin-top: 60px">
                    <div class="card-header">
                        <h6 class="text-uppercase mb-0">关于 平均绩点</h6>
                    </div>
                    <div class="card-body">
                        <ul>
                            <li><h6>在美国大学评估申请者的背景条件中，其中一个指标就是申请者的GPA，即Grade Point
                                Average（平均绩点成绩）的缩写。在申请学校的时候，GPA十分的重要，它是反应申请者学习能力的指标。
                            </h6></li>
                            <li><h6>平均学分绩点是将分数换算为绩点，之后按学分加权平均分方法计算。</h6></li>
                            <li><h6>平均学分绩点=∑(课程学分×成绩绩点)/∑课程学分=各门课程学分绩点之和/各门课程学分数之和</h6></li>
                            <li><h6>本系统中，您只需要成功获取成绩后，选择相应计算标准，即可轻松获得该算法下的平均学分绩点。</h6></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 mb-5">
                <div class="card">
                    <div class="card-header">
                        <h6 class="text-uppercase mb-0">算法计算规则</h6>
                    </div>
                    <div class="card-body">
                        <table class="table card-text" id="bz">
                            <tr>
                                <th>成绩</th>
                                <th>分数</th>
                            </tr>
                            <tr>
                                <td>100-90</td>
                                <td>4.0</td>
                            </tr>
                            <tr>
                                <td>89-80</td>
                                <td>3.0</td>
                            </tr>
                            <tr>
                                <td>79-70</td>
                                <td>2.0</td>
                            </tr>
                            <tr>
                                <td>69-60</td>
                                <td>1.0</td>
                            </tr>
                            <tr>
                                <td>59-0</td>
                                <td>0</td>
                            </tr>
                        </table>
                        <table class="table card-text" id="gj">
                            <tr>
                                <th>成绩</th>
                                <th>分数</th>
                            </tr>
                            <tr>
                                <td>100-85</td>
                                <td>4.0</td>
                            </tr>
                            <tr>
                                <td>84-70</td>
                                <td>3.0</td>
                            </tr>
                            <tr>
                                <td>69-60</td>
                                <td>2.0</td>
                            </tr>
                            <tr>
                                <td>59-0</td>
                                <td>0</td>
                            </tr>
                        </table>
                        <table class="table card-text" id="gj2">
                            <tr>
                                <th>成绩</th>
                                <th>分数</th>
                            </tr>
                            <tr>
                                <td>100-85</td>
                                <td>4.0</td>
                            </tr>
                            <tr>
                                <td>84-75</td>
                                <td>3.0</td>
                            </tr>
                            <tr>
                                <td>74-60</td>
                                <td>2.0</td>
                            </tr>
                            <tr>
                                <td>59-0</td>
                                <td>0</td>
                            </tr>
                        </table>
                        <table class="table card-text" id="bd">
                            <tr>
                                <th>成绩</th>
                                <th>分数</th>
                            </tr>
                            <tr>
                                <td>100-90</td>
                                <td>4.0</td>
                            </tr>
                            <tr>
                                <td>89-85</td>
                                <td>3.7</td>
                            </tr>
                            <tr>
                                <td>84-82</td>
                                <td>3.3</td>
                            </tr>
                            <tr>
                                <td>81-78</td>
                                <td>3.0</td>
                            </tr>
                            <tr>
                                <td>77-75</td>
                                <td>2.7</td>
                            </tr>
                            <tr>
                                <td>74-72</td>
                                <td>2.3</td>
                            </tr>
                            <tr>
                                <td>71-68</td>
                                <td>2.0</td>
                            </tr>
                            <tr>
                                <td>67-64</td>
                                <td>1.5</td>
                            </tr>
                            <tr>
                                <td>63-60</td>
                                <td>1.0</td>
                            </tr>
                            <tr>
                                <td>59-0</td>
                                <td>0</td>
                            </tr>
                        </table>
                        <table class="table card-text" id="jnd">
                            <tr>
                                <th>成绩</th>
                                <th>分数</th>
                            </tr>
                            <tr>
                                <td>100-90</td>
                                <td>4.3</td>
                            </tr>
                            <tr>
                                <td>89-85</td>
                                <td>4.0</td>
                            </tr>
                            <tr>
                                <td>84-80</td>
                                <td>3.7</td>
                            </tr>
                            <tr>
                                <td>79-75</td>
                                <td>3.3</td>
                            </tr>
                            <tr>
                                <td>74-70</td>
                                <td>3.0</td>
                            </tr>
                            <tr>
                                <td>69-65</td>
                                <td>2.7</td>
                            </tr>
                            <tr>
                                <td>64-60</td>
                                <td>2.3</td>
                            </tr>
                            <tr>
                                <td>59-0</td>
                                <td>0</td>
                            </tr>
                        </table>
                        <table class="table card-text" id="zkd">
                            <tr>
                                <th>成绩</th>
                                <th>分数</th>
                            </tr>
                            <tr>
                                <td>100-95</td>
                                <td>4.3</td>
                            </tr>
                            <tr>
                                <td>94-90</td>
                                <td>4.0</td>
                            </tr>
                            <tr>
                                <td>89-85</td>
                                <td>3.7</td>
                            </tr>
                            <tr>
                                <td>84-82</td>
                                <td>3.3</td>
                            </tr>
                            <tr>
                                <td>81-78</td>
                                <td>3.0</td>
                            </tr>
                            <tr>
                                <td>77-75</td>
                                <td>2.7</td>
                            </tr>
                            <tr>
                                <td>74-72</td>
                                <td>2.3</td>
                            </tr>
                            <tr>
                                <td>71-68</td>
                                <td>2.0</td>
                            </tr>
                            <tr>
                                <td>67-65</td>
                                <td>1.7</td>
                            </tr>
                            <tr>
                                <td>64-64</td>
                                <td>1.5</td>
                            </tr>
                            <tr>
                                <td>63-61</td>
                                <td>1.3</td>
                            </tr>
                            <tr>
                                <td>60-60</td>
                                <td>1.0</td>
                            </tr>
                            <tr>
                                <td>59-0</td>
                                <td>0</td>
                            </tr>
                        </table>
                        <table class="table card-text" id="shjd">
                            <tr>
                                <th>成绩</th>
                                <th>分数</th>
                            </tr>
                            <tr>
                                <td>100-95</td>
                                <td>4.3</td>
                            </tr>
                            <tr>
                                <td>94-90</td>
                                <td>4.0</td>
                            </tr>
                            <tr>
                                <td>89-85</td>
                                <td>3.7</td>
                            </tr>
                            <tr>
                                <td>84-80</td>
                                <td>3.3</td>
                            </tr>
                            <tr>
                                <td>79-75</td>
                                <td>3.0</td>
                            </tr>
                            <tr>
                                <td>74-70</td>
                                <td>2.7</td>
                            </tr>
                            <tr>
                                <td>69-67</td>
                                <td>2.3</td>
                            </tr>
                            <tr>
                                <td>66-65</td>
                                <td>2.0</td>
                            </tr>
                            <tr>
                                <td>64-62</td>
                                <td>1.7</td>
                            </tr>
                            <tr>
                                <td>61-60</td>
                                <td>1.0</td>
                            </tr>
                            <tr>
                                <td>59-0</td>
                                <td>0</td>
                            </tr>
                        </table>
                        <table class="table card-text" id="zb">
                            <tr><td colspan="2" align="center">平均学分绩点=∑(课程绩点×课程学分)/∑课程学分</td></tr>
                            <tr><th>课程绩点计算办法：</th><th></th></tr>
                            <tr><th colspan="2">百分制记分：</th></tr>
                            <tr><td colspan="2">课程成绩不足60分的绩点为0,超过60分的(包含60分)的算法为：</td></tr>
                            <tr><td colspan="2" align="center">课程绩点=课程成绩/10-5(保留一位小数)</td></tr>
                            <tr><th colspan="2">五分制记分：</th></tr>
                            <tr><td colspan="2">优秀：4.5绩点；良好：3.5绩点；中等：2.5绩点；及格：1.5绩点；不及格：0绩点；</td></tr>
                        </table>
                    </div>
                </div>
            </div>

        {% endif %}
    </div>
{% endblock %}

{% block js %}
    <script type="text/javascript">
        $('table#zb').show().siblings().hide();
        $('select#mode').change(function () {
            let mode = $(this).val();
            $('table#' + mode + '').show().siblings().hide();
            $.get(
                '{% url "student:gpa" %}',
                {'mode': mode},
                function (result) {
                    if (result['status']) {
                        $('#point').text(result['point'])
                    }
                }
            )
        });
        $('#export').click(function () {
            let school = $('select#mode').val();
            window.open('{% url "student:export_excel" %}?mode=' + school)
        })
    </script>
{% endblock %}